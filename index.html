<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>El Rincón del Profe Orlando - Intervalos</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <style>
        /* Animaciones personalizadas */
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        .animate-shake { animation: shake 0.3s ease-in-out; }
        .animate-fade-in { animation: fadeIn 0.5s ease-out; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        
        /* Prevenir selección de texto en botones para sensación de App nativa */
        button { user-select: none; -webkit-tap-highlight-color: transparent; }
        body { overscroll-behavior-y: none; }
    </style>
</head>
<body class="bg-gray-50 h-screen w-screen overflow-hidden">

    <div id="root" class="h-full w-full"></div>

    <script type="text/babel">
        // --- CONFIGURACIÓN REACT ---
        const { useState, useEffect, useMemo } = React;

        // --- ICONOS (Recreados para no depender de librerías externas) ---
        const IconBase = ({ d, className, size = 24 }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                {d}
            </svg>
        );

        const Play = (p) => <IconBase {...p} d={<polygon points="5 3 19 12 5 21 5 3"></polygon>} />;
        const BookOpen = (p) => <IconBase {...p} d={<path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path>} />;
        const Music = (p) => <IconBase {...p} d={<path d="M9 18V5l12-2v13"></path><circle cx="6" cy="18" r="3"></circle><circle cx="18" cy="16" r="3"></circle>} />;
        const Check = (p) => <IconBase {...p} d={<polyline points="20 6 9 17 4 12"></polyline>} />;
        const X = (p) => <IconBase {...p} d={<line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line>} />;
        const Volume2 = (p) => <IconBase {...p} d={<polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon><path d="M19.07 4.93a10 10 0 0 1 0 14.14M15.54 8.46a5 5 0 0 1 0 7.07"></path>} />;
        const RefreshCw = (p) => <IconBase {...p} d={<polyline points="23 4 23 10 17 10"></polyline><polyline points="1 20 1 14 7 14"></polyline><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path>} />;
        const Trophy = (p) => <IconBase {...p} d={<path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"></path><path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"></path><path d="M4 22h16"></path><path d="M10 14.66V17"></path><path d="M14 14.66V17"></path><path d="M12 2v8a4 4 0 0 0 8 0V2z"></path><path d="M12 2v8a4 4 0 0 1-8 0V2z"></path>} />;
        const ArrowUp = (p) => <IconBase {...p} d={<line x1="12" y1="19" x2="12" y2="5"></line><polyline points="5 12 12 5 19 12"></polyline>} />;
        const ArrowDown = (p) => <IconBase {...p} d={<line x1="12" y1="5" x2="12" y2="19"></line><polyline points="19 12 12 19 5 12"></polyline>} />;
        const Sparkles = (p) => <IconBase {...p} d={<path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z"></path>} />;
        const Layers = (p) => <IconBase {...p} d={<polygon points="12 2 2 7 12 12 22 7 12 2"></polygon><polyline points="2 17 12 22 22 17"></polyline><polyline points="2 12 12 17 22 12"></polyline>} />;
        const Activity = (p) => <IconBase {...p} d={<polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>} />;

        // --- ICONOS MUSICALES ESPECIALES ---
        const TrebleClef = ({ className }) => (
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round" className={className}>
            <path d="M9 18V5l12-2v13" style={{opacity: 0}} />
            <path d="M10.7 18.8c.6.4 1.4.2 1.8-.4.5-.7.2-1.8-.6-2.2-.8-.4-1.7.2-1.7 1.1 0 .9.8 1.5 1.7 1.1z" />
            <path d="M12.2 16.2c-2.3-1.3-3-4.3-1.5-6.6 1.1-1.8 3.5-2.2 4.9-.8 1.3 1.3.8 3.6-.8 4.6-1.5 1-3.3.4-3.7-1.4-.4-1.7.9-3.3 2.6-3.4 1.5-.1 2.8 1.1 2.8 2.6v9.3c0 1.9-1.6 3.5-3.5 3.5-1.5 0-2.8-1-3.3-2.4" />
        </svg>
        );

        const BassClef = ({ className }) => (
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round" className={className}>
            <path d="M6 6c0 5 4 9 9 9s9-4 9-9" style={{opacity: 0}} /> 
            <path d="M15.5 15.5c-2.8 0-5-2.2-5-5s2.2-5 5-5c2.3 0 4.2 1.5 4.8 3.6" />
            <circle cx="15.5" cy="5.5" r="1.5" fill="currentColor" />
            <circle cx="6" cy="7" r="1" fill="currentColor" />
            <circle cx="6" cy="11" r="1" fill="currentColor" />
        </svg>
        );

        const QuarterNote = ({ className }) => (
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
            <circle cx="9" cy="18" r="3.5" fill="currentColor" />
            <path d="M12.5 18V5" />
        </svg>
        );

        const BeamedNotes = ({ className }) => (
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
            <circle cx="6" cy="18" r="3" fill="currentColor" />
            <circle cx="18" cy="16" r="3" fill="currentColor" />
            <path d="M9 18V5l12-2v13" />
        </svg>
        );

        const StaffLines = ({ className }) => (
        <svg viewBox="0 0 100 40" fill="none" stroke="currentColor" strokeWidth="0.5" className={className} preserveAspectRatio="none">
            <path d="M0 10h100M0 15h100M0 20h100M0 25h100M0 30h100" />
        </svg>
        );

        // --- COMPONENTES AUXILIARES ---

        const IntervalExampleVisual = ({ type, isPlaying }) => {
        return (
            <div className="relative w-full h-20 bg-white rounded-lg border border-gray-100 flex items-center justify-center overflow-hidden">
            <div className="absolute inset-0 flex flex-col justify-center opacity-30 pointer-events-none">
                <StaffLines className="w-full text-gray-800" />
            </div>
            
            <svg viewBox="0 0 100 40" className="w-full h-full absolute inset-0 text-indigo-900 pointer-events-none">
                <path d="M15 32 C 12 32, 10 28, 12 24 C 14 20, 18 20, 18 16 C 18 13, 16 11, 15 13 C 13 16, 12 25, 15 35" fill="none" stroke="currentColor" strokeWidth="0.5" opacity="0.5" />
                
                {type === 'asc' && (
                <>
                    <line x1="25" y1="35" x2="35" y2="35" stroke="currentColor" strokeWidth="0.5" />
                    <circle cx="30" cy="35" r="2.5" fill={isPlaying ? "#4ade80" : "currentColor"} className="transition-colors duration-300" />
                    <line x1="32.5" y1="35" x2="32.5" y2="15" stroke="currentColor" strokeWidth="0.5" />
                    <circle cx="50" cy="25" r="2.5" fill={isPlaying ? "#4ade80" : "currentColor"} className={`transition-colors duration-300 ${isPlaying ? 'delay-500' : ''}`} />
                    <line x1="52.5" y1="25" x2="52.5" y2="5" stroke="currentColor" strokeWidth="0.5" />
                    <path d="M 35 30 Q 40 20 45 28" fill="none" stroke="#6366f1" strokeWidth="0.5" strokeDasharray="2 1" opacity="0.6"/>
                </>
                )}

                {type === 'desc' && (
                <>
                    <circle cx="30" cy="25" r="2.5" fill={isPlaying ? "#facc15" : "currentColor"} className="transition-colors duration-300" />
                    <line x1="32.5" y1="25" x2="32.5" y2="5" stroke="currentColor" strokeWidth="0.5" />
                    <line x1="45" y1="35" x2="55" y2="35" stroke="currentColor" strokeWidth="0.5" />
                    <circle cx="50" cy="35" r="2.5" fill={isPlaying ? "#facc15" : "currentColor"} className={`transition-colors duration-300 ${isPlaying ? 'delay-500' : ''}`} />
                    <line x1="52.5" y1="35" x2="52.5" y2="15" stroke="currentColor" strokeWidth="0.5" />
                    <path d="M 35 28 Q 40 38 45 30" fill="none" stroke="#f59e0b" strokeWidth="0.5" strokeDasharray="2 1" opacity="0.6"/>
                </>
                )}

                {type === 'harm' && (
                <>
                    <line x1="35" y1="35" x2="45" y2="35" stroke="currentColor" strokeWidth="0.5" />
                    <circle cx="40" cy="35" r="2.5" fill={isPlaying ? "#a855f7" : "currentColor"} className="transition-colors duration-300" />
                    <line x1="42.5" y1="35" x2="42.5" y2="15" stroke="currentColor" strokeWidth="0.5" />
                    <circle cx="40" cy="25" r="2.5" fill={isPlaying ? "#a855f7" : "currentColor"} className="transition-colors duration-300" />
                    <line x1="42.5" y1="25" x2="42.5" y2="5" stroke="currentColor" strokeWidth="0.5" />
                </>
                )}
            </svg>
            </div>
        );
        };

        // --- DATOS Y TRADUCCIONES ---

        const TRANSLATIONS = {
        es: {
            title: 'Intervalos',
            subtitle: 'Laboratorio Sonoro',
            description: 'Herramienta pedagógica para el desarrollo del oído musical.',
            instructionBtn: 'Zona de Instrucción',
            typesBtn: 'Tipos de Intervalos',
            trainingBtn: 'Zona de Entrenamiento',
            footer: 'Diseñado para el programa de Música | Prof. Orlando Gómez',
            learnTitle: 'Guía de Intervalos',
            typesTitle: 'Tipos de Movimiento',
            back: 'Volver',
            listen: 'Escuchar',
            semitones: 'ST',
            tones: 'T',
            exit: 'Salir',
            score: 'Aciertos',
            attempts: 'Intentos',
            difficulty: 'Dificultad',
            levelBasic: 'Nivel Básico',
            levelChromatic: 'Nivel Cromático',
            playing: 'Reproduciendo...',
            touchToRepeat: 'Repetir',
            correct: '¡Excelente!',
            incorrect: 'Ups, intenta de nuevo',
            isA: 'Es una',
            listenPrompt: '¿Qué intervalo escuchas?',
            start: 'Comenzar',
            next: 'Siguiente',
            direction: 'Dirección',
            ascName: 'Ascendente',
            descName: 'Descendente',
            harmName: 'Armónico',
            ascDef: 'Notas consecutivas, de grave a agudo (subiendo). Sensación de apertura.',
            descDef: 'Notas consecutivas, de agudo a grave (bajando). Sensación de cierre.',
            harmDef: 'Notas simultáneas. Crea la textura y el "color" vertical del acorde.',
        },
        en: {
            title: 'Intervals',
            subtitle: 'Sound Laboratory',
            description: 'Pedagogical tool for ear training development.',
            instructionBtn: 'Instruction Zone',
            typesBtn: 'Interval Types',
            trainingBtn: 'Training Zone',
            footer: 'Designed for the Music Program | Prof. Orlando Gómez',
            learnTitle: 'Interval Guide',
            typesTitle: 'Types of Motion',
            back: 'Back',
            listen: 'Listen',
            semitones: 'ST',
            tones: 'T',
            exit: 'Exit',
            score: 'Score',
            attempts: 'Attempts',
            difficulty: 'Difficulty',
            levelBasic: 'Basic Level',
            levelChromatic: 'Chromatic Level',
            playing: 'Playing...',
            touchToRepeat: 'Repeat',
            correct: 'Excellent!',
            incorrect: 'Oops, try again',
            isA: 'It is a',
            listenPrompt: 'Which interval is this?',
            start: 'Start',
            next: 'Next',
            direction: 'Direction',
            ascName: 'Ascending',
            descName: 'Descending',
            harmName: 'Harmonic',
            ascDef: 'Consecutive notes, low to high. Sense of opening.',
            descDef: 'Consecutive notes, high to low. Sense of closure.',
            harmDef: 'Simultaneous notes. Vertical texture and chord color.',
        }
        };

        const INTERVALS = [
        { 
            semitones: 0, tones: '0', short: 'P1',
            colorTheme: 'gray', 
            name: { es: 'Unísono Justo', en: 'Perfect Unison' },
            desc: { es: 'La misma nota repetida.', en: 'The same note repeated.' },
            songs: { asc: { es: 'Jingle Bells (Ritmo)', en: 'Jingle Bells (Rhythm)' }, desc: { es: 'Happy Birthday (Inicio)', en: 'Happy Birthday (Start)' } }
        },
        { 
            semitones: 1, tones: '0.5', short: 'm2', 
            colorTheme: 'rose', 
            name: { es: '2da Menor', en: 'Minor 2nd' },
            desc: { es: 'Disonante, tenso.', en: 'Dissonant, tense.' },
            songs: { asc: { es: 'Tiburón (Jaws)', en: 'Jaws (Theme)' }, desc: { es: 'Para Elisa (Fur Elise)', en: 'Fur Elise' } }
        },
        { 
            semitones: 2, tones: '1', short: 'M2', 
            colorTheme: 'orange', 
            name: { es: '2da Mayor', en: 'Major 2nd' },
            desc: { es: 'Paso entero, escalas.', en: 'Whole step, major scales.' },
            songs: { asc: { es: 'Cumpleaños Feliz', en: 'Happy Birthday' }, desc: { es: 'Yesterday (The Beatles)', en: 'Yesterday (The Beatles)' } }
        },
        { 
            semitones: 3, tones: '1.5', short: 'm3', 
            colorTheme: 'amber', 
            name: { es: '3ra Menor', en: 'Minor 3rd' },
            desc: { es: 'Triste, melancólico.', en: 'Sad, melancholic.' },
            songs: { asc: { es: 'Seven Nation Army', en: 'Seven Nation Army' }, desc: { es: 'Hey Jude (The Beatles)', en: 'Hey Jude (The Beatles)' } }
        },
        { 
            semitones: 4, tones: '2', short: 'M3', 
            colorTheme: 'lime', 
            name: { es: '3ra Mayor', en: 'Major 3rd' },
            desc: { es: 'Brillante, alegre.', en: 'Bright, happy.' },
            songs: { asc: { es: 'When the Saints', en: 'When the Saints' }, desc: { es: '5ta Sinfonía Beethoven', en: 'Beethoven\'s 5th' } }
        },
        { 
            semitones: 5, tones: '2.5', short: 'P4', 
            colorTheme: 'emerald', 
            name: { es: '4ta Justa', en: 'Perfect 4th' },
            desc: { es: 'Estable, solemne.', en: 'Stable, solemn.' },
            songs: { asc: { es: 'Amazing Grace', en: 'Amazing Grace' }, desc: { es: 'Pequeña Serenata (Mozart)', en: 'Eine Kleine Nachtmusik' } }
        },
        { 
            semitones: 6, tones: '3', short: 'TT', 
            colorTheme: 'fuchsia', 
            name: { es: 'Tritono', en: 'Tritone' }, 
            desc: { es: 'Disonancia máxima.', en: 'Max dissonance.' },
            songs: { asc: { es: 'Los Simpson (Intro)', en: 'The Simpsons (Intro)' }, desc: { es: 'Black Sabbath (Riff)', en: 'Black Sabbath (Riff)' } }
        },
        { 
            semitones: 7, tones: '3.5', short: 'P5', 
            colorTheme: 'sky', 
            name: { es: '5ta Justa', en:
